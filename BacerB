-- Main GUI
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local guiParent = player:WaitForChild("PlayerGui")
local HttpService = game:GetService("HttpService")

local screenGui = Instance.new("ScreenGui", guiParent)
screenGui.IgnoreGuiInset = true

-- Main draggable frame
local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Size = UDim2.new(0, 350, 0, 180)
mainFrame.Position = UDim2.new(0, 100, 0, 100)
mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
mainFrame.Active = true
mainFrame.Draggable = true

-- Title
local title = Instance.new("TextLabel", mainFrame)
title.Size = UDim2.new(1,-16,0,20)
title.Position = UDim2.new(0,8,0,8)
title.BackgroundTransparency = 1
title.Text = "Touch Football GK"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 16
title.TextXAlignment = Enum.TextXAlignment.Left

-- Close button (top-right)
local closeBtn = Instance.new("TextButton", mainFrame)
closeBtn.Size = UDim2.new(0, 24, 0, 24)
closeBtn.Position = UDim2.new(1, -28, 0, 4)
closeBtn.Text = "X"
closeBtn.TextColor3 = Color3.new(1,1,1)
closeBtn.BackgroundColor3 = Color3.fromRGB(200,0,0)
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 18

-- Draggable GK square
local gkSquare = Instance.new("Frame", screenGui)
gkSquare.Size = UDim2.new(0, 60, 0, 60)
gkSquare.Position = UDim2.new(0, 150, 0, 250)
gkSquare.BackgroundColor3 = Color3.fromRGB(0,150,0)
gkSquare.Visible = false
gkSquare.Active = true
gkSquare.Draggable = true

local gkLabel = Instance.new("TextLabel", gkSquare)
gkLabel.Size = UDim2.new(1,0,1,0)
gkLabel.BackgroundTransparency = 1
gkLabel.Text = "GK"
gkLabel.TextColor3 = Color3.new(1,1,1)
gkLabel.Font = Enum.Font.SourceSansBold
gkLabel.TextSize = 18
gkLabel.TextScaled = true

closeBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    gkSquare.Visible = true
end)

-- GK Toggle Button
local gkBtn = Instance.new("TextButton", mainFrame)
gkBtn.Size = UDim2.new(0, 80, 0, 30)
gkBtn.Position = UDim2.new(0, 8, 0, 40)
gkBtn.Text = "GK"
gkBtn.Font = Enum.Font.SourceSansBold
gkBtn.TextSize = 16
gkBtn.BackgroundColor3 = Color3.fromRGB(100,100,100)
gkBtn.TextColor3 = Color3.new(1,1,1)

local GK = false
local connections = {}

-- Original GK script
local function runGK()
	if not GK then return end
	local char = player.Character or player.CharacterAdded:Wait()
	local field = workspace:WaitForChild("FootballField")
	local ball = field:FindFirstChild("SoccerBall")
	local diveIds = {"rbxassetid://16428780736","rbxassetid://16428788224","rbxassetid://16428773038","rbxassetid://16428797277"}

	local function updateBall() ball = field:FindFirstChild("SoccerBall") end

	local function teleportBall()
		if char and ball then
			local hrp = char:FindFirstChild("HumanoidRootPart")
			if hrp then
				local pos = hrp.CFrame + (hrp.CFrame.LookVector*2)
				if ball:IsA("BasePart") then
					ball.CFrame = pos
				elseif ball:IsA("Model") and ball.PrimaryPart then
					ball:SetPrimaryPartCFrame(pos)
				end
			end
		end
	end

	local humanoid = char:WaitForChild("Humanoid")
	local animator = humanoid:FindFirstChildOfClass("Animator")
	if animator then
		local conn = animator.AnimationPlayed:Connect(function(track)
			if not GK then return end
			if table.find(diveIds, track.Animation.AnimationId) then
				teleportBall()
			end
		end)
		table.insert(connections, conn)
	end

	local conn2 = field.ChildAdded:Connect(function(c) if c.Name=="SoccerBall" then ball=c end end)
	table.insert(connections, conn2)
	updateBall()
end

gkBtn.MouseButton1Click:Connect(function()
	GK = not GK
	if GK then
		gkBtn.Text = "ON"
		gkBtn.BackgroundColor3 = Color3.fromRGB(0,255,0)
		runGK()
	else
		gkBtn.Text = "OFF"
		gkBtn.BackgroundColor3 = Color3.fromRGB(255,0,0)
		for _,c in pairs(connections) do c:Disconnect() end
		connections = {}
	end
end)

-- Suggestions TextBox
local suggestionBox = Instance.new("TextBox", mainFrame)
suggestionBox.Size = UDim2.new(0, 200, 0, 25)
suggestionBox.Position = UDim2.new(0, 100, 0, 40)
suggestionBox.BackgroundColor3 = Color3.fromRGB(50,50,50)
suggestionBox.Text = "Suggestions"
suggestionBox.TextColor3 = Color3.new(1,1,1)
suggestionBox.Font = Enum.Font.SourceSans
suggestionBox.TextSize = 14
suggestionBox.ClearTextOnFocus = true
suggestionBox.PlaceholderText = "Type suggestion and press Enter"

suggestionBox.FocusLost:Connect(function(enterPressed)
	if enterPressed then
		local suggestion = suggestionBox.Text
		if suggestion and suggestion ~= "" then
			if player.Name ~= "Milesjhr2015" then
				suggestionBox.Text = "Cooldown 1 day"
			else
				suggestionBox.Text = "" -- allow unlimited for Milesjhr2015
			end

			-- Send to Discord webhook
			local data = {
				content = player.Name .. ": " .. suggestion
			}
			local jsonData = HttpService:JSONEncode(data)
			pcall(function()
				HttpService:PostAsync(
					"https://discord.com/api/webhooks/1416790074166739106/Iw21z8PO7grKb-L1RgeFvI0RjJ5rqFEkg4PWKNs2lQ7SK-ufiDqPie9rcT",
					jsonData,
					Enum.HttpContentType.ApplicationJson
				)
			end)
		end
	end
end)

-- Discord Buttons
local discordB = Instance.new("TextButton", mainFrame)
discordB.Size = UDim2.new(0,110,0,25)
discordB.Position = UDim2.new(0,8,0,120)
discordB.BackgroundColor3 = Color3.fromRGB(88,101,242)
discordB.Text = "BacerB Discord"
discordB.Font = Enum.Font.SourceSansBold
discordB.TextSize = 14
discordB.TextColor3 = Color3.new(1,1,1)
discordB.MouseButton1Click:Connect(function()
	if setclipboard then setclipboard("https://discord.gg/TmbjdmFZ") end
end)

local discordD = Instance.new("TextButton", mainFrame)
discordD.Size = UDim2.new(0,110,0,25)
discordD.Position = UDim2.new(0,132,0,120)
discordD.BackgroundColor3 = Color3.fromRGB(114,137,218)
discordD.Text = "Dev Discord"
discordD.Font = Enum.Font.SourceSansBold
discordD.TextSize = 14
discordD.TextColor3 = Color3.new(1,1,1)
discordD.MouseButton1Click:Connect(function()
	if setclipboard then setclipboard("https://discord.gg/W9kkzz8t") end
end)
